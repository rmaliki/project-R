newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..)), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..)), position='dodge', binwidth=15))  + ylab("Pourcentage") +xlab("Age")
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=an_nais,fill=grave),position="fill")
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=an_nais,fill=grav),position="fill")
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=an_nais,fill=grav),position="fill")
library(plotly)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=an_nais,fill=grav),position="fill")
library("plotly"")
ggplotly(plotly)
library("plotly"")
)
)
)
)
require(plotly)
install.packages(plotly)
install.packages("plotly"")
install.packages("plotly")
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=an_nais,fill=grav),position="fill")
library("plotly)
ggplotly(p)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=an_nais,fill=grav),position="fill")
library("plotly")
ggplotly(p)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill")
library("plotly")
ggplotly(p)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill")
library("plotly")
ggplotly(p)
p<-p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent')
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill")
library("plotly")
p<-ggplotly(p)
p<-p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent')
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill")
library("plotly")
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent')
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill")
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")-
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill")
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent')
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent')
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=0.3)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=0.5)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap='0.5')
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=1)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10,width = 0.5)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10,width = 0.5)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth = 10)+geom_bar(width = 0.5)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",width = 0.4)
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10,yaxis=list(tickformat='%'))
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(,y=y*100,x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(y=y*100,x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_bar(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10,yaxis=list(tickformat='%'))
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')+ ylab("Pourcentage") +xlab("Age")
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10,yaxis=list(tickformat='%'))
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(y=y*100,x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')+ ylab("Pourcentage") +xlab("Age")
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')+ ylab("Pourcentage") +xlab("Age")+scale()
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
require(scales)
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')+ ylab("Pourcentage") +xlab("Age")
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)
p<-ggplotly(p)
require(scales)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10,yaxis=list(tickformat='%'))
#Removing missing values
#NAindex <- apply(users,2,function(x) {sum(is.na(x))})
#users <- users[,which(NAindex == 0)]
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
qplot(an_nais,data=newus,color=grav,binwidth=10,xlim =c(1925,2005))
#ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(aes(y=c((..count..[..group..==1])*100/sum(..count..),(..count..[..group..==2])*100/sum(..count..))), position='dodge', binwidth=15)  + ylab("Pourcentage") +xlab("Age")
require(scales)
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')+ ylab("Pourcentage") +xlab("Age")
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)+scale_y_continuous(labels = scales::percent)
p<-ggplotly(p)
require(scales)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10,yaxis=list(tickformat='%'))
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
require(scales)
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')+ ylab("Pourcentage") +xlab("Age")
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)+scale_y_continuous(labels = scales::percent)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10,yaxis=list(tickformat='%'))
knitr::opts_chunk$set(echo = TRUE)
library("ggplot2")
library("caret")
#library("randomForest")
# Reading datasets
characteristics<-read.csv("Données/caracteristiques_2015.csv")
locations<-read.csv("Données/lieux_2015.csv")
users<-read.csv("Données/usagers_2015.csv")
vehicle<-read.csv("Données/vehicules_2015.csv")
newus<-users[,c("an_nais","grav")]
newus$grav=factor(newus$grav)
levels(newus$grav)=c("Pas grave","Grave","Grave","Pas grave")
require(scales)
p<-ggplot(newus, aes(2015-an_nais,fill=grav))+geom_histogram(data = newus, aes(x=2015-an_nais,fill=grav),position="fill",binwidth =10,color='white')+ ylab("Pourcentage") +xlab("Age")
library("plotly")
palet_couleur<-c('#520202','#21B6A8')
names(palet_couleur)<-c("Grave","Pas grave")
p<-p+scale_fill_manual(name="accidents",values = palet_couleur)+scale_y_continuous(labels = scales::percent)
p<-ggplotly(p)
p%>%layout(paper_bgcolor='transparent',plot_bgcolor='transparent',bargap=10,yaxis=list(tickformat='%'))
df<-merge(users, vehicle)
df$grav=factor(df$grav)
levels(df$grav)=c("Pas grave","Grave","Grave","Pas grave")
df$grav=factor(df$grav)
df$catu=factor(df$catu,labels = c("Conducteur","Passager","Piéton ","Piéton en roller"))
qplot(an_nais,catv,data=df,color=grav,xlim =c(1925,2005))
plot(pressure)
